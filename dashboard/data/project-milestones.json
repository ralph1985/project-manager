[
  {
    "id": 1,
    "projectId": "speedy-basket",
    "title": "Estructura y plantillas (docs base)",
    "status": "Done",
    "order": 1,
    "note": "Documentar vision, arquitectura, datos y sync.",
    "details": "Estructura\n\n/docs\n  STATUS.md\n  01-vision.md\n  02-architecture.md\n  03-data-model.md\n  04-sync.md\n  05-roadmap.md\n  /adr\n    ADR-0001-expo.md\n    ADR-0002-sqlite-outbox.md\n  /runbooks\n    local-dev.md\n    release.md\n\ndocs/STATUS.md\n\n# Estado del proyecto\n\n## Qué funciona hoy\n- [x] App arranca\n- [x] SQLite inicializada\n- [x] Import pack local\n- [x] Lista / búsqueda\n- [x] Mapa por zonas (SVG)\n- [x] Outbox events\n- [x] Sync: POST /events\n- [x] Sync: GET /pack delta\n\n## Qué está roto / pendiente crítico\n- -\n\n## Próximas 1–3 tareas (concretas)\n1.\n2.\n3.\n\n## Cómo levantar en local\n- App: `pnpm dev:app`\n- Backend: `pnpm dev:api`\n- Reset DB local: `pnpm db:reset`\n- Seed pack: `pnpm pack:import`\n\n## Notas rápidas\n- Última vez que toqué esto: 04/01/2026\n- Riesgos abiertos:\n  - \n\ndocs/01-vision.md\n\n# Visión\n\n## Problema\nPerder tiempo en el súper por no encontrar productos y por cambios de ubicación.\n\n## Usuario objetivo\n- Compra habitual en la misma tienda (ej. Mercadona concreto).\n\n## Propuesta de valor\n- Lista + búsqueda + “zona probable” offline.\n- Confirmación en 1 tap para mejorar datos.\n\n## MVP (sí o sí)\n- 1 tienda, mapa por zonas.\n- Lista, búsqueda, detalle producto.\n- Feedback: encontrado / no está.\n- Offline-first con SQLite.\n\n## Fuera del MVP\n- Navegación indoor exacta por pasillos.\n- Visión por fotos de lineal.\n- Cobertura multi-cadena.\n\ndocs/02-architecture.md\n\n# Arquitectura\n\n## Componentes\n- App (RN/Expo) + SQLite local\n- API (REST)\n- Postgres (central)\n- Generación de packs (versionado/deltas)\n\n## Flujo offline-first\n1) App usa SQLite siempre.\n2) Acciones -> outbox_events\n3) Con red: POST /events (batch)\n4) App descarga delta: GET /pack?since=V\n\n## Principios\n- El móvil NO escribe “estado final” central.\n- Solo manda eventos; el backend consolida.\n\ndocs/03-data-model.md\n\n# Modelo de datos\n\n## SQLite (app)\n- stores(id, name)\n- zones(id, store_id, name, polygon_or_meta)\n- products(id, name, brand, ean?, category)\n- product_locations(product_id, store_id, zone_id, confidence, updated_at)\n- outbox_events(id, type, payload_json, created_at, sent_at?)\n\n## Postgres (central)\n- stores\n- zones\n- products\n- events (append-only)\n- product_locations (consolidado)\n- store_packs (store_id, version, created_at, hash, size)\n\n## Índices / claves\n- events: (store_id, created_at)\n- product_locations: (store_id, product_id) unique\n\ndocs/04-sync.md\n\n# Sync\n\n## Eventos (móvil -> backend)\nTipos:\n- FOUND(productId, storeId, zoneId?)\n- NOT_FOUND(productId, storeId)\n- SCANNED_EAN(ean, storeId, zoneId?)\n\nReglas:\n- Idempotencia: event.id único\n- Batch: hasta N eventos por request\n\n## Packs (backend -> móvil)\n- GET /stores/:id/pack?since=version\nRespuesta:\n- version\n- delta: upserts/deletes por tabla lógica\n- checksum/hash\n\n## Conflictos\n- Se resuelven en backend:\n  - recencia + cantidad de confirmaciones\n  - confidence decay por tiempo\n\ndocs/05-roadmap.md\n\n# Roadmap\n\n## Fase 1: App offline (MVP)\n- [ ] Navegación básica + SQLite + pack local\n- [ ] Lista/búsqueda/detalle\n- [ ] Mapa por zonas (SVG)\n- [ ] Dev screens mínimas\n\n## Fase 2: Backend + sync v1\n- [ ] POST /events\n- [ ] GET /pack delta\n- [ ] Reglas confidence v1\n\n## Fase 3: Carga inicial tienda\n- [ ] Admin básico (web o dev mode)\n- [ ] Seed por categorías\n\n## Fase 4: Escaneo + UX\n- [ ] Barcode\n- [ ] Ruta por zonas\n\ndocs/adr/ADR-0001-expo.md\n\n# ADR-0001: Expo + React Native\n\n## Decisión\nUsar Expo para acelerar desarrollo y pruebas en móvil sin compilar continuamente.\n\n## Motivo\n- Menos fricción y setup\n- Buen soporte cámara/permissions/builds\n\n## Consecuencias\n- Dependencia de Expo/EAS para builds (aceptable en MVP)\n\ndocs/adr/ADR-0002-sqlite-outbox.md\n\n# ADR-0002: SQLite + Outbox events\n\n## Decisión\nSQLite local como fuente de UX; sync por outbox de eventos + deltas.\n\n## Motivo\n- Offline-first real\n- Evita conflictos complejos\n\n## Consecuencias\n- Hay que implementar pack versioning y procesos de consolidación en backend\n\ndocs/runbooks/local-dev.md\n\n# Runbook: desarrollo local\n\n## Requisitos\n- Node + pnpm\n- Expo Go (móvil)\n\n## Comandos\n- App: `pnpm dev:app`\n- API: `pnpm dev:api`\n- Reset: `pnpm db:reset`\n\n## Backend local desde el movil\n- Usa la IP local de tu maquina (ej. `http://192.168.1.209:3001`) en la configuracion de la app.\n- Comprueba que el movil y el ordenador estan en la misma red.\n\n## Debug\n- Flipper: logs + network\n- Dev screens: DB Viewer / Outbox / Packs / Export\n\ndocs/runbooks/release.md\n\n# Runbook: releases\n\n## App\n- Incrementar versión\n- Build con EAS\n- Publicar stores\n\n## Backend\n- Migraciones Postgres\n- Deploy\n- Verificar endpoints /pack y /events"
  },
  {
    "id": 2,
    "projectId": "speedy-basket",
    "title": "Backlog accionable (MVP offline base)",
    "status": "Done",
    "order": 2,
    "note": "Backlog ejecutado: MVP offline funcional completado.",
    "details": "Objetivo\n\nEsqueleto funcional offline completado:\n- App arranca\n- SQLite creada\n- Pack local importado\n- Pantallas base\n- Dev tools mínimas\n\nBacklog inicial (completado)\n\n1) Bootstrap del proyecto\n- Repo monorepo creado.\n- App Expo + TypeScript.\n- Estructura /apps, /packages, /docs.\n- Script pnpm dev:app.\n\n2) SQLite local\n- Helper SQLite.\n- Tablas: stores, zones, products, product_locations, outbox_events.\n\n3) Import de pack local (seed)\n- JSON mock de tienda + zonas + productos.\n- Import al arranque si la BD está vacía.\n- Pack version guardada.\n\n4) Pantallas core\n- Lista de compra, búsqueda y detalle producto.\n- Botones Encontrado / No está generan eventos.\n\n5) Outbox de eventos\n- Eventos guardados en outbox_events.\n- Tipos: FOUND / NOT_FOUND.\n\n6) Mapa por zonas (mínimo)\n- SVG simple con zonas clicables.\n\n7) Dev screens\n- Activación oculta.\n- DB Viewer, Outbox viewer, Reset + reimport pack.\n\nSiguiente paso\nBackend + sync v1."
  },
  {
    "id": 3,
    "projectId": "speedy-basket",
    "title": "Monorepo (justificación + estructura)",
    "status": "Done",
    "order": 3,
    "note": "Monorepo activo con apps y paquetes compartidos.",
    "details": "Monorepo aplicado\n- Un solo repo para app, backend y shared.\n- Offline-first con contrato compartido.\n\nEstructura vigente\n/\n├─ apps/\n│  ├─ mobile/   # Expo / React Native\n│  └─ api/      # Backend (REST)\n├─ packages/\n│  └─ shared/   # tipos y contratos de sync\n├─ docs/\n├─ package.json\n└─ pnpm-workspace.yaml\n\nShared incluye\n- Tipos Pack, Event, EventType.\n- Contratos request/response de sync.\n\nEstado\n- Monorepo en funcionamiento."
  },
  {
    "id": 4,
    "projectId": "speedy-basket",
    "title": "Crear monorepo (acción inmediata)",
    "status": "Done",
    "order": 4,
    "details": "Acción completada\n1. Repo monorepo creado.\n2. pnpm-workspace.yaml añadido.\n3. Carpetas creadas:\n   - apps/mobile\n   - apps/api\n   - packages/shared\n   - docs\n4. Docs base añadida.\n5. Bootstrap Expo + SQLite completado.\n\nSiguiente paso\nSync v1 y delta incremental."
  },
  {
    "id": 5,
    "projectId": "speedy-basket",
    "title": "Sync v1 estable (events + delta + consolidación)",
    "status": "Done",
    "order": 5,
    "note": "Eventos, consolidación y delta incremental en API.",
    "details": "Completado\n\n- POST /events estable (FOUND / NOT_FOUND / SCANNED_EAN)\n- Actualización de product_locations con reglas de confianza\n- GET /pack con delta incremental\n- Versionado en store_packs\n\nEntregables\n- Consolidación básica de ubicaciones\n- Delta incremental por updated_at\n- Tests manuales con curls"
  },
  {
    "id": 6,
    "projectId": "speedy-basket",
    "title": "App conectada a API (sync real)",
    "status": "Done",
    "order": 6,
    "note": "La app deja de usar pack local como única fuente.",
    "details": "Completado\n\n- Fetch de /pack desde móvil\n- Envío de outbox a /events\n- Manejo básico de errores y reintentos\n\nEntregables\n- Sync manual desde dev screen\n- UI mínima de estado de sync"
  },
  {
    "id": 7,
    "projectId": "speedy-basket",
    "title": "Carga inicial tienda (packs versionados)",
    "status": "Planned",
    "order": 7,
    "note": "Proceso de seed y packs para una tienda real.",
    "details": "Objetivo\n\n- Herramienta de seed inicial (JSON / CSV)\n- Generación de packs con versionado\n- Validaciones mínimas\n\nEntregables\n- Script de import y generación de packs"
  },
  {
    "id": 8,
    "projectId": "speedy-basket",
    "title": "Ruta/UX (mapa por zonas + flujo de lista)",
    "status": "Planned",
    "order": 8,
    "note": "Pulir la experiencia del usuario final.",
    "details": "Objetivo\n\n- Mapa de zonas útil en móvil\n- Flujo de lista y búsqueda optimizado\n- Feedback rápido (Encontrado / No está)\n\nEntregables\n- UX de ruta por zonas\n- Iteración de UI"
  },
  {
    "id": 9,
    "projectId": "speedy-basket",
    "title": "Pulir confianza (acumulativo, umbrales y escaneo)",
    "status": "Planned",
    "order": 9,
    "note": "Afinar reglas de confianza y señal de escaneo.",
    "details": "Objetivo\n\n- Definir pesos por evento (FOUND / NOT_FOUND / SCANNED_EAN)\n- Ajustar acumulacion, limites 0-1 y decaimiento\n- Establecer umbrales de sugerida vs confirmada\n- Manejar cambios de zona y conflictos\n\nEntregables\n- Reglas de confianza documentadas\n- Actualizacion consistente de product_locations\n- Pruebas manuales con curls"
  },
  {
    "id": 10,
    "projectId": "speedy-basket",
    "title": "Usuarios, roles y listas privadas",
    "status": "Planned",
    "order": 10,
    "note": "Auth obligatorio + listas privadas compartibles.",
    "details": "Esquema\n\n- profiles (id = auth.users.id)\n- roles (admin, map_editor, store_editor, user)\n- user_roles (por tienda)\n- stores.created_by\n- events.user_id\n- shopping_lists + members + items\n\nReglas\n\n- Login obligatorio (Supabase Auth)\n- Roles por tienda\n- Listas privadas con miembros (owner/editor/viewer)\n- Tiendas visibles para cualquier usuario autenticado\n\nEntregables\n\n- Migraciones SQL + RLS\n- Ajustes API para auth\n- UI de login + listas"
  },
  {
    "id": 11,
    "projectId": "speedy-basket",
    "title": "Listas compartidas (endpoints mínimos)",
    "status": "Planned",
    "order": 11,
    "note": "API para listas privadas y miembros.",
    "details": "Objetivo\n\n- GET /lists\n- POST /lists\n- POST /lists/:id/members\n- GET /lists/:id/items\n- POST /lists/:id/items\n- PATCH /lists/:id/items/:itemId\n\nEntregables\n\n- Endpoints con auth\n- RLS validada con roles owner/editor/viewer"
  },
  {
    "id": 12,
    "projectId": "loto-sync",
    "title": "Hito 1: Definicion MVP y modelo de datos",
    "status": "Done",
    "order": 1,
    "note": "Cerrar pantallas, flujo y entidades principales.",
    "details": "Entregables\n\n- Pantallas MVP: seleccion sorteo/grupo + alta boleto\n- Entidades: groups, draws, tickets, ticket_numbers, receipts\n- Estados: pendiente / comprobado / premio\n- Campos minimos y validaciones"
  },
  {
    "id": 13,
    "projectId": "loto-sync",
    "title": "Hito 2: Bootstrap Next.js + entorno Vercel",
    "status": "Done",
    "order": 2,
    "note": "Repo base y configuracion minima para deploy.",
    "details": "Entregables\n\n- Next.js app creada en projects/loto-sync\n- Variables de entorno base\n- Configuracion Vercel Blob + Prisma Postgres"
  },
  {
    "id": 14,
    "projectId": "loto-sync",
    "title": "Hito 3: Alta de boleto (UI + validaciones)",
    "status": "Done",
    "order": 3,
    "note": "Formulario movil y flujo de guardado.",
    "details": "Entregables\n\n- Formulario de numeros y tipo de sorteo\n- Selector de grupo\n- Validaciones y feedback"
  },
  {
    "id": 15,
    "projectId": "loto-sync",
    "title": "Hito 4: Resguardos con Blob + metadatos en DB",
    "status": "Planned",
    "order": 4,
    "note": "Subida de imagen y relacion con boleto.",
    "details": "Entregables\n\n- Upload a Vercel Blob\n- Guardado URL + metadata en Postgres\n- Vista detalle con resguardo"
  },
  {
    "id": 16,
    "projectId": "loto-sync",
    "title": "Hito 5: Pantalla de revision y estado por grupo",
    "status": "Planned",
    "order": 5,
    "note": "Listado filtrado por grupo y estado.",
    "details": "Entregables\n\n- Dashboard movil con filtros\n- Estados de boleto: pendiente / comprobado / premio"
  }
]
